From 1cb61ca81df2a18ff8a0cc2a4968e4ffe7f9fffc Mon Sep 17 00:00:00 2001
From: Mike Hommey <mh@glandium.org>
Date: Sun, 11 May 2014 15:08:37 +0900
Subject: Use "firefox" instead of MOZ_APP_NAME for profile reset


diff --git a/toolkit/modules/ResetProfile.jsm b/toolkit/modules/ResetProfile.jsm
index c4c2567..3ba756f 100644
--- a/toolkit/modules/ResetProfile.jsm
+++ b/toolkit/modules/ResetProfile.jsm
@@ -7,7 +7,7 @@
 this.EXPORTED_SYMBOLS = ["ResetProfile"];
 
 const {classes: Cc, interfaces: Ci, utils: Cu, results: Cr} = Components;
-#expand const MOZ_APP_NAME = "__MOZ_APP_NAME__";
+const MOZ_APP_NAME = "firefox";
 #expand const MOZ_BUILD_APP = "__MOZ_BUILD_APP__";
 
 Cu.import("resource://gre/modules/Services.jsm");
diff --git a/toolkit/xre/nsAppRunner.cpp b/toolkit/xre/nsAppRunner.cpp
index b287d01..f97effc 100644
--- a/toolkit/xre/nsAppRunner.cpp
+++ b/toolkit/xre/nsAppRunner.cpp
@@ -4037,7 +4037,7 @@ XREMain::XRE_mainRun()
         if (gDoProfileReset) {
           // Automatically migrate from the current application if we just
           // reset the profile.
-          aKey = MOZ_APP_NAME;
+          aKey = "firefox";
         }
         pm->Migrate(&mDirProvider, aKey);
       }
-- 
cgit v0.10.2
